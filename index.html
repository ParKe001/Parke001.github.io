<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth transition-colors duration-500">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Paker">
    <meta name="keywords" content="个人主页">
    <link rel="icon" href="favicon.png" type="image/x-icon">
    <title>Paker的主页</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/qweather-icons@1.7.0/font/qweather-icons.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        .hidden {
            display: none !important;
        }
        
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: row;
            overflow-x: hidden;
            position: relative;
            margin: 0;
            padding: 0;
        }

        .sidebar {
            width: 380px;
            min-width: 380px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            z-index: 10;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .dark .sidebar {
            background: rgba(31, 41, 55, 0.85);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            padding: 2rem;
            position: relative;
            z-index: 1;
        }

        .avatar-container {
            width: 180px;
            height: 180px;
            margin: 0 auto;
            position: relative;
        }

        .avatar-glow {
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, #3b82f6, #8b5cf6, #ec4899, #3b82f6);
            border-radius: 50%;
            filter: blur(10px);
            opacity: 0.4;
            z-index: -1;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .announcement-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border-left: 3px solid transparent;
        }

        .announcement-item:hover {
            border-left-color: #3b82f6;
            transform: translateX(5px);
            background: rgba(59, 130, 246, 0.05);
        }

        .announcement-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .badge-new {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .badge-update {
            background: linear-gradient(135deg, #10b981, #047857);
            color: white;
        }

        .badge-fix {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: white;
        }

        .grid-horizontal {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .time-display-horizontal {
            font-size: 2.5rem;
            letter-spacing: 2px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .dark .time-display-horizontal {
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 1024px) {
            body {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                min-width: 100%;
                border-right: none;
                border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            }
            .dark .sidebar {
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }
        }

        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .dark .card-hover {
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .dark .card-hover:hover {
            border-color: rgba(59, 130, 246, 0.5);
        }

        .social-icon-horizontal {
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 12px;
            background: rgba(59, 130, 246, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .social-icon-horizontal:hover {
            transform: translateY(-3px) scale(1.1);
            background: rgba(59, 130, 246, 0.2);
        }

        .loader-horizontal {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 1;
            visibility: visible;
            transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1), visibility 0.6s;
        }

        .dark .loader-horizontal {
            background: linear-gradient(135deg, #111827, #1f2937);
        }

        .animation-delay-100 { animation-delay: 0.1s; }
        .animation-delay-200 { animation-delay: 0.2s; }
        .animation-delay-300 { animation-delay: 0.3s; }
        .animation-delay-400 { animation-delay: 0.4s; }
        .animation-delay-500 { animation-delay: 0.5s; }
        
        .transition-all-300 {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .avatar-loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modal-overlay.active {
            opacity: 1;
            display: flex;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.9);
            padding: 2rem;
            border-radius: 1rem;
            width: 90%;
            max-width: 500px;
            transform: translateY(30px) scale(0.95);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0) scale(1);
            opacity: 1;
        }

        .dark .modal-content {
            background: rgba(31, 41, 55, 0.9);
        }

        .code-block {
            background: rgba(248, 248, 248, 0.9);
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            margin: 1rem 0;
            border: 1px solid rgba(0, 0, 0, 0.1);
            overflow-x: auto;
            user-select: all;
            font-size: 0.9rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .code-block:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .dark .code-block {
            background: rgba(55, 65, 81, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .copy-btn {
            background: #3b82f6;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
        }

        .copy-btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.3);
        }

        .music-note {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 50;
            color: #3b82f6;
            font-size: 1.5rem;
            animation: musicFloat 3s ease-in-out infinite;
        }

        @keyframes musicFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }

        .dark .music-note {
            color: #60a5fa;
        }

        .meteor {
            position: fixed;
            top: -50px;
            width: 2px;
            height: 30px;
            background: linear-gradient(to bottom, transparent, #fff);
            filter: drop-shadow(0 0 6px #3b82f6);
            z-index: 0;
            opacity: 0;
            pointer-events: none;
        }

        .dark .meteor {
            background: linear-gradient(to bottom, transparent, #60a5fa);
            filter: drop-shadow(0 0 10px #60a5fa);
        }

        @keyframes meteor {
            0% {
                opacity: 0;
                transform: translateY(0) rotate(-45deg);
            }
            10% {
                opacity: 1;
            }
            70% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(100vh) translateX(100vw) rotate(-45deg);
            }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 transition-colors duration-500">
    <div class="loader-horizontal">
        <div class="text-center">
            <div class="spinner mx-auto mb-4"></div>
            <div class="text-2xl font-bold text-gray-700 dark:text-gray-200 mb-2">正在加载横屏布局</div>
            <div class="text-gray-500 dark:text-gray-400">请稍候...</div>
        </div>
    </div>

    <aside class="sidebar">
        <div class="p-8 flex-1">
            <div class="avatar-container mb-8">
                <div class="avatar-glow"></div>
                <div class="w-full h-full rounded-full border-4 border-white dark:border-gray-800 shadow-lg overflow-hidden avatar-loading">
                    <img id="avatar" src="https://raw.githubusercontent.com/ParKe001/ParKe/refs/heads/main/picture/retouch_2026011523381676.png" alt="头像" class="w-full h-full object-cover">
                </div>
            </div>

            <h1 id="nickname" class="text-3xl font-bold mb-2 text-center transition-all-300 hover:text-blue-500 dark:hover:text-blue-400">Paker</h1>
            <p id="bio" class="text-gray-600 dark:text-gray-400 mb-6 text-center">购买Secular Hub 去这里∶卡密网址</p>

            <div class="mb-8 p-4 bg-white dark:bg-gray-800 rounded-xl shadow-md text-center card-hover">
                <div id="time-display" class="time-display-horizontal font-bold text-gray-700 dark:text-gray-200">--:--:--</div>
                <div class="text-sm text-gray-500 dark:text-gray-400 mt-2">当前时间</div>
            </div>

            <div class="mb-8 p-4 bg-white dark:bg-gray-800 rounded-xl shadow-md card-hover">
                <div class="flex items-center space-x-4">
                    <i id="weather-icon" class="qi-200 text-4xl text-blue-500 dark:text-blue-400"></i>
                    <div>
                        <p id="weather-city" class="text-sm font-semibold text-gray-700 dark:text-gray-200">加载中...</p>
                        <p id="weather-temp" class="text-xl font-bold text-gray-900 dark:text-gray-100">--°C</p>
                    </div>
                </div>
            </div>

            <div class="mb-8">
                <h3 class="text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300">联系方式</h3>
                <div class="flex justify-center space-x-4">
                    <a href="https://qm.qq.com/q/xokMTw1UNG" target="_blank" class="social-icon-horizontal text-blue-500 hover:text-blue-600">
                        <i class="fab fa-qq text-xl"></i>
                    </a>
                    <a href="https://github.com/ParKe001" target="_blank" class="social-icon-horizontal text-gray-700 hover:text-gray-900 dark:text-gray-300 dark:hover:text-white">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>

            <div class="p-4 bg-white dark:bg-gray-800 rounded-xl shadow-md cursor-pointer card-hover" onclick="loadHitokoto()">
                <p id="hitokoto-text" class="text-sm italic text-gray-600 dark:text-gray-400 text-center">点击加载一言...</p>
            </div>
        </div>

        <div class="p-4 border-t border-gray-200 dark:border-gray-700 text-center">
            <p class="text-sm text-gray-500 dark:text-gray-400 mb-1">© 2025 Pakerの主页</p>
            <a href="https://beian.miit.gov.cn" target="_blank" class="text-xs text-gray-400 hover:text-blue-500 dark:hover:text-blue-400 transition-all-300">京ICP备88888888号</a>
        </div>
    </aside>

    <main class="main-content">
        <section class="mb-8">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-3xl font-bold text-gray-800 dark:text-gray-200">最新公告</h2>
                <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-all-300 flex items-center" onclick="openScriptModal()">
                    <i class="fas fa-code mr-2"></i>获取QQ和卡密
                </button>
            </div>

            <div class="grid-horizontal">
                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover animation-delay-100">
                    <div class="flex items-center mb-4">
                        <span class="announcement-badge badge-new">NEW</span>
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-200">网站更新通知</h3>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">这是Paker的个人主页 我每当发布脚本就会在此做介绍</p>
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        <i class="far fa-calendar mr-1"></i> 2025-01-17
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover animation-delay-200">
                    <div class="flex items-center mb-4">
                        <span class="announcement-badge badge-update">UPDATE</span>
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-200">脚本更新发布</h3>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">Secular Hub 新的一款Wanted脚本 功能多样 功能强悍 有意请联系我 QQ:1993818288</p>
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        <i class="far fa-calendar mr-1"></i> 2025-01-15
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover animation-delay-300">
                    <div class="flex items-center mb-4">
                        <span class="announcement-badge badge-fix">FIX</span>
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-200">修复记录</h3>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400 mb-4">修复了卡顿问题 修复了粒子效果 修复了绕过问题</p>
                    <div class="text-sm text-gray-500 dark:text-gray-400">
                        <i class="far fa-calendar mr-1"></i> 2025-01-12
                    </div>
                </div>
            </div>
        </section>

        <section class="mb-8">
            <h2 class="text-3xl font-bold mb-6 text-gray-800 dark:text-gray-200">详细信息</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-6">
                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200 flex items-center">
                            <i class="fas fa-user mr-2 text-blue-500"></i>关于我
                        </h3>
                        <p class="text-gray-600 dark:text-gray-400 mb-4">一个平平无奇的脚本小白 Secular Hub团队的制作者 代理之一</p>
                        <div class="space-y-2">
                            <div class="flex items-center text-gray-600 dark:text-gray-400">
                                <i class="fas fa-map-marker-alt mr-2 text-blue-500"></i>
                                <span>所在城市：<span id="location">泉州</span></span>
                            </div>
                            <div class="flex items-center text-gray-600 dark:text-gray-400">
                                <i class="fas fa-code mr-2 text-blue-500"></i>
                                <span>可以联系我聊天</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover">
                        <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200 flex items-center">兴趣爱好</h3>
                        <div class="flex flex-wrap gap-2">
                            <span class="px-3 py-1 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded-full text-sm">编程</span>
                            <span class="px-3 py-1 bg-green-100 dark:bg-green-900 text-green-600 dark:text-green-300 rounded-full text-sm">游戏</span>
                            <span class="px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-300 rounded-full text-sm">音乐</span>
                            <span class="px-3 py-1 bg-yellow-100 dark:bg-yellow-900 text-yellow-600 dark:text-yellow-300 rounded-full text-sm">阅读</span>
                        </div>
                    </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-xl shadow-md p-6 card-hover">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200 flex items-center">
                        <i class="fas fa-star mr-2 text-yellow-500"></i>最新动态
                    </h3>
                    <div class="space-y-4">
                        <div class="announcement-item p-3 rounded-lg">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-medium text-gray-700 dark:text-gray-300">GitHub 项目更新</span>
                                <span class="text-xs text-gray-500">1天前</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">上传了最新的脚本文件，优化了执行逻辑</p>
                        </div>
                        <div class="announcement-item p-3 rounded-lg">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-medium text-gray-700 dark:text-gray-300">新增</span>
                                <span class="text-xs text-gray-500">3天前</span>
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400">增添了粒子效果开关</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div class="music-note">
        <i class="fas fa-music"></i>
    </div>

    <div id="scriptModal" class="modal-overlay" onclick="closeScriptModal(event)">
        <div class="modal-content">
            <h2 class="text-xl font-bold mb-4 transition-all-300 hover:text-blue-500 dark:hover:text-blue-400">QQ号 和卡密网址</h2>
            <div class="code-block" id="scriptCode">1993818288 卡密网址∶zzz</div>
            <div class="flex justify-between">
                <button class="copy-btn" onclick="copyScript()">
                    <i class="fas fa-copy mr-2"></i>复制
                </button>
                <button class="copy-btn bg-red-500 hover:bg-red-600" onclick="closeScriptModal()">
                    <i class="fas fa-times mr-2"></i>关闭
                </button>
            </div>
        </div>
    </div>

    <script>
        const config = {
            qqNumber: '2556017764',
            backgroundImage: 'https://raw.githubusercontent.com/ParKe001/ParKe/refs/heads/main/picture/image_download_1768633804210.jpg',
            defaultWeatherCity: '泉州'
        };

        let bgMusic = new Audio('http://music.163.com/song/media/outer/url?id=1414845505.mp3');
        bgMusic.loop = true;
        bgMusic.volume = 0.3;
        let musicStarted = false;

        function createMeteors() {
            const meteorCount = 15;
            for (let i = 0; i < meteorCount; i++) {
                setTimeout(() => {
                    const meteor = document.createElement('div');
                    meteor.className = 'meteor';
                    meteor.style.left = Math.random() * 100 + 'vw';
                    meteor.style.animation = `meteor ${Math.random() * 3 + 2}s linear ${Math.random() * 10}s infinite`;
                    document.body.appendChild(meteor);
                }, i * 100);
            }
        }

        function startMusic() {
            if (musicStarted) return;
            
            bgMusic.play().then(() => {
                musicStarted = true;
            }).catch(e => {
                document.body.addEventListener('click', function initMusic() {
                    if (musicStarted) return;
                    bgMusic.play();
                    musicStarted = true;
                    document.body.removeEventListener('click', initMusic);
                }, { once: true });
            });
        }

        function loadHitokoto() {
            const hitokotoText = document.getElementById('hitokoto-text');
            hitokotoText.classList.add('transition-all-300');
            hitokotoText.textContent = '加载中...';
            
            fetch('https://api.fohok.xin/API/yiyan2.php')
                .then(response => response.ok ? response.text() : Promise.reject('网络请求失败'))
                .then(text => {
                    hitokotoText.textContent = text;
                })
                .catch(error => {
                    console.error('加载一言失败:', error);
                    hitokotoText.textContent = '我在不断学习 可望突破';
                });
        }

        function loadUserInfo() {
            const avatarEl = document.getElementById('avatar');
            avatarEl.onload = () => {
                if (avatarEl.parentElement) {
                    avatarEl.parentElement.classList.remove('avatar-loading');
                }
            };
            avatarEl.onerror = () => {
                if (avatarEl.parentElement) {
                    avatarEl.parentElement.classList.remove('avatar-loading');
                }
                avatarEl.src = 'https://via.placeholder.com/400x400?text=Paker';
            };
        }

        function updateTime() {
            const timeDisplayEl = document.getElementById('time-display');
            if (timeDisplayEl) {
                const now = new Date();
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');
                timeDisplayEl.textContent = `${hours}:${minutes}:${seconds}`;
            }
        }

        function setupTheme() {
            const htmlEl = document.documentElement;
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                htmlEl.classList.add('dark');
            } else {
                htmlEl.classList.remove('dark');
            }
        }

        async function getCityNameFromCoordinates(latitude, longitude) {
            try {
                const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}`);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                return data.address?.city || data.address?.town || data.address?.village || data.address?.county || null;
            } catch (error) {
                console.error('获取城市名称失败:', error);
                return null;
            }
        }

        async function loadWeatherData(city) {
            const weatherCityEl = document.getElementById('weather-city');
            const weatherTempEl = document.getElementById('weather-temp');
            const weatherIconEl = document.getElementById('weather-icon');
            const locationEl = document.getElementById('location');

            if (!weatherCityEl || !weatherTempEl || !weatherIconEl || !locationEl) return;

            weatherCityEl.textContent = '加载中...';
            weatherTempEl.textContent = '--°C';
            weatherIconEl.className = 'qi-200 text-4xl text-blue-500 dark:text-blue-400';

            try {
                const response = await fetch(`https://api.fohok.xin/API/hftq.php?city=${encodeURIComponent(city)}`);
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const data = await response.json();
                
                if (data.code === 200 && data.data) {
                    weatherCityEl.textContent = data.city;
                    weatherTempEl.textContent = `${data.data.temp}°C`;
                    weatherIconEl.className = `qi-${data.data.icon} text-4xl text-blue-500 dark:text-blue-400`;
                    locationEl.textContent = data.city;
                } else {
                    throw new Error(data.message || '未知错误');
                }
            } catch (error) {
                console.error('加载天气数据失败:', error);
                weatherCityEl.textContent = '获取失败';
                weatherTempEl.textContent = '--°C';
                weatherIconEl.className = 'qi-200 text-4xl text-gray-500 dark:text-gray-400';
            }
        }

        function initializeUI() {
            setupTheme();
            createMeteors();

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const { latitude, longitude } = position.coords;
                        const cityName = await getCityNameFromCoordinates(latitude, longitude);
                        loadWeatherData(cityName || config.defaultWeatherCity);
                    },
                    (error) => {
                        console.warn('无法获取用户定位，原因:', error.message);
                        loadWeatherData(config.defaultWeatherCity);
                    },
                    { enableHighAccuracy: false, timeout: 5000, maximumAge: 0 }
                );
            } else {
                loadWeatherData(config.defaultWeatherCity);
            }

            setInterval(updateTime, 1000);
            updateTime();
        }

        function openScriptModal() {
            const modal = document.getElementById('scriptModal');
            if (modal) {
                modal.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeScriptModal(event) {
            const modal = document.getElementById('scriptModal');
            if (!modal) return;
            
            if (event && event.target.id === 'scriptModal') {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            } else if (!event) {
                modal.classList.remove('active');
                document.body.style.overflow = '';
            }
        }

        function copyScript() {
            const codeEl = document.getElementById('scriptCode');
            if (!codeEl) return;
            
            const code = codeEl.textContent;
            navigator.clipboard.writeText(code).then(() => {
                const btn = document.querySelector('.copy-btn');
                if (btn) {
                    const originalText = btn.innerHTML;
                    btn.innerHTML = '<i class="fas fa-check mr-2"></i>已复制';
                    setTimeout(() => {
                        btn.innerHTML = originalText;
                    }, 2000);
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            loadUserInfo();
            loadHitokoto();
            initializeUI();
            
            setTimeout(() => {
                const loader = document.querySelector('.loader-horizontal');
                if (loader) {
                    loader.style.opacity = '0';
                    loader.style.visibility = 'hidden';
                    
                    setTimeout(() => {
                        loader.classList.add('hidden');
                        startMusic();
                        
                        const cards = document.querySelectorAll('.card-hover');
                        cards.forEach((card, index) => {
                            card.style.opacity = '0';
                            card.style.transform = 'translateY(20px)';
                            setTimeout(() => {
                                card.style.transition = 'all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1)';
                                card.style.opacity = '1';
                                card.style.transform = 'translateY(0)';
                            }, 100 + index * 100);
                        });
                    }, 600);
                }
            }, 1500);
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeScriptModal();
            }
        });

        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'A' && e.target.href && e.target.target !== '_blank') {
                e.preventDefault();
                const loader = document.querySelector('.loader-horizontal');
                if (loader) {
                    loader.classList.remove('hidden');
                    loader.style.opacity = '1';
                    loader.style.visibility = 'visible';
                }
                setTimeout(() => {
                    window.location.href = e.target.href;
                }, 600);
            }
        });
    </script>
</body>
</html>
